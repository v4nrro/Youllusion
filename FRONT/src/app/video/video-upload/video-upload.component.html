<div class="d-flex align-items-center justify-content-center">
    <div class="login-container">
        <div class="d-flex align-items-center">
            <img src="/images/favicon.jpg" class="app-logo" alt="App Logo" />
            <h1 class="ms-3">Upload video</h1>
        </div>

        <div class="mt-3 ms-2">
            <form
                [formGroup]="videoForm"
                (ngSubmit)="upload()"
                id="form-login"
            >
                <div class="mb-3">
                    <label>Video</label>
                    <input
                        type="file"
                        class="form-control"
                        accept="video/*"
                        encodeBase64
                        (change)="onFileSelected($event, 'video')"
                        formControlName="video"
                        [validationClasses]="{
                            valid: 'is-valid',
                            invalid: 'is-invalid'
                        }"
                    />
                    <div class="invalid-feedback">Select your video</div>
                </div>

                <div class="mb-3">
                    <label class="form-label"
                        >Title</label
                    >
                    <input
                        type="text"
                        formControlName="title"
                        placeholder="Title"
                        class="form-control"
                        [validationClasses]="{
                            valid: 'is-valid',
                            invalid: 'is-invalid'
                        }"
                    />

                    @let titleError = videoForm.get('title')?.errors;
                    @if(titleError?.['required']){
                    <div class="invalid-feedback">Title is required</div>
                    }
                </div>

                <div class="mb-3">
                    <label class="form-label">Description</label>

                    <input
                        type="text"
                        formControlName="description"
                        placeholder="Video description..."
                        class="form-control"
                        [validationClasses]="{
                            valid: 'is-valid',
                            invalid: 'is-invalid'
                        }"
                    />

                    @let descriptionError = videoForm.get('description')?.errors;
                    @if(descriptionError?.['required']){
                    <div class="invalid-feedback">Description is required</div>
                    }
                </div>

                <div class="mb-3">
                    <label class="form-label">Price</label>

                    <input
                        type="number"
                        formControlName="price"
                        placeholder="â‚¬"
                        class="form-control"
                        [validationClasses]="{
                            valid: 'is-valid',
                            invalid: 'is-invalid'
                        }"
                    />

                    @let priceError =
                    videoForm.get('price')?.errors;
                    @if(priceError ?.['min']){
                    <div class="invalid-feedback">
                        Price can't be less than 0 
                    </div>
                    }
                    @if(priceError ?.['required']) {
                        <div class="invalid-feedback">
                            Price must be 0 or higher
                        </div>
                    }
                </div>

                <div class="mb-3">
                    <label>Miniature</label>
                    <input
                        type="file"
                        class="form-control"
                        accept="image/*"
                        encodeBase64
                        (change)="onFileSelected($event, 'miniature')"
                        formControlName="miniature"
                        [validationClasses]="{
                            valid: 'is-valid',
                            invalid: 'is-invalid'
                        }"
                    />
                    <div class="invalid-feedback">The miniature is required</div>
                </div>

                <input type="file" class="form-control"
                        accept="image/*" (change)="fileChangeEvent($event)" />

                <image-cropper
                    [imageChangedEvent]="imageChangedEvent"
                    [maintainAspectRatio]="true"
                    [aspectRatio]="4 / 3"
                    format="png"
                    (imageCropped)="imageCropped($event)"
                    (imageLoaded)="imageLoaded($event)"
                    (cropperReady)="cropperReady()"
                    (loadImageFailed)="loadImageFailed()"
                ></image-cropper>

                <img [src]="croppedImage"/>

                @if(selectedMiniature){
                    <img
                        [src]="imagePreview()"
                        alt=""
                        class="img-thumbnail mb-3"
                    />
                }

                <div class="d-flex align-items-center">
                    <button type="submit" class="btn btn-primary">
                        Upload
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
